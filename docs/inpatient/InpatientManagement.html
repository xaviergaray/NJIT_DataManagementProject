<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Newark Medical Associates - In-patient Management</title>
    <link rel="stylesheet" type="text/css" href="../styles.css">
    <style>
        .scrollBoxContainer {
            display: inline-block;
            width: auto;
            height: 80vh;
            overflow: auto;
        }

        /* CSS for the scroll box */
        #scrollBox {
            
        }

        /* CSS for the table */
        #databaseItems {
            border-collapse: separate;
            border-spacing: 2em;  /* Increase this value to increase spacing */
            table-layout: auto;
        }

        #databaseItems th, #databaseItems td {
            text-align: center;
        }

        /* CSS for the sticky header */
        #databaseItems th {
            position: sticky;
            top: 0;
            background: white;  /* Change this to match your table's background color */
        }

        h3 {
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Newark Medical Associates</h1>
        <h2>In-patient Management</h2>

        <div class="scrollBoxContainer">
            <h3>Room Availability</h3>
            <div id="scrollBox">
                <table id="databaseItems">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nursing Unit</th>
                            <th>Wing</th>
                            <th>Room Number</th>
                            <th>Bed Number</th>
                            <th>Assigned Patient</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Rows from the database will be inserted here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // JavaScript to fetch data from the Flask route and populate the table
        window.onload = async function() {
            var databaseItems = document.getElementById('databaseItems');

            let responseBeds = await fetch('/get-beds');
            let beds = await responseBeds.json();

            let responsePatients = await fetch('/get-patients');
            let patient = await responsePatients.json();

            for (var i = 0; i < beds.length; i++) {
                var row = document.createElement('tr');

                var idCell = document.createElement('td');
                idCell.textContent = beds[i].ID;
                row.appendChild(idCell);

                var nursingUnitCell = document.createElement('td');
                nursingUnitCell.textContent = beds[i].NursingUnit;
                row.appendChild(nursingUnitCell);

                var wingCell = document.createElement('td');
                wingCell.textContent = beds[i].Wing;
                row.appendChild(wingCell);

                var roomNumberCell = document.createElement('td');
                roomNumberCell.textContent = beds[i].RoomNumber;
                row.appendChild(roomNumberCell);

                var bedNumberCell = document.createElement('td');
                bedNumberCell.textContent = beds[i].BedNumber;
                row.appendChild(bedNumberCell);

                let responsePatient = await fetch(`/get-patient-by-bed-id/${beds[i].ID}`);
                let patient = await responsePatient.json();
                var patientCell = document.createElement('td');
                patientCell.textContent = patient.Name
                row.appendChild(patientCell);

                databaseItems.querySelector('tbody').appendChild(row);
            }
        };
    </script>
</body>
</html>
